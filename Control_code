import flet as ft
import pandas as pd

df_excel = pd.read_excel('Results.xlsx')

count = 0
def main(page: ft.Page):
    global count
    hello_text = ft.Text('Привет! Тапай хомяка')
    message_text = ft.Text(f'Вы кликнули: {count}')

    def Count(e):
        global count
        count += 1
        message_text.value = f'Вы кликнули: {count}'
        page.update()

    def Del(e):
        global count
        count = 0
        message_text.value = f'Вы кликнули: {count}'
        page.update()

    def Save(e):
        global count, df_excel

        df_excel.loc[0, 'Result'] = count

        # Сохраняем обновленный DataFrame в Excel
        df_excel.to_excel('Results.xlsx', index=False)

    butt_click = ft.ElevatedButton("Тапнуть", on_click=Count)
    butt_del = ft.ElevatedButton("Сбросить", on_click=Del)
    butt_save = ft.ElevatedButton("Сохранить", on_click=Save)

    page.add(hello_text, butt_click, message_text, butt_del, butt_save)

ft.app(target=main)
